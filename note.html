<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>蘿嵐随记簿 - 个人日记</title>
    <!-- 引入Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- 引入marked库用于Markdown渲染 -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- 引入手写字体 -->
    <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=ZCOOL+XiaoWei&family=ZCOOL+QingKe+HuangYou&display=swap" rel="stylesheet">

    <!-- Tailwind CSS 配置 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    // 莫兰迪色系配置
                    colors: {
                        // 主色调
                        primary: '#A288E3', // 淡紫色
                        secondary: '#B8A9C9', // 浅紫色
                        // 背景色
                        'diary-bg': '#F8F4E3', // 米黄色
                        'diary-paper': '#FFF8E7', // 纸张色
                        // 文字颜色
                        'diary-text': '#5D4E6D', // 深紫色文字
                        'diary-text-secondary': '#8D86C9', // 中紫色文字
                        // 边框和分隔线
                        'diary-border': '#D3C9C0', // 浅棕色边框
                        // 强调色
                        'accent-1': '#C9ADC6', // 灰紫色
                        'accent-2': '#EAC7C7', // 淡粉色
                        'accent-3': '#A0C3D2', // 淡蓝色
                        'accent-4': '#B7C4CF', // 浅灰色
                    },
                    fontFamily: {
                        // 手写风格字体
                        'handwriting': ['Ma Shan Zheng', 'cursive'],
                        'diary': ['ZCOOL XiaoWei', 'serif'],
                        'title': ['ZCOOL QingKe HuangYou', 'sans-serif'],
                    },
                },
            }
        }
    </script>

    <!-- 自定义工具类 -->
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .text-shadow {
                text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
            }
            .diary-shadow {
                box-shadow: 0 4px 12px rgba(162, 136, 227, 0.15);
            }
            .paper-texture {
                background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23a288e3' fill-opacity='0.05' fill-rule='evenodd'/%3E%3C/svg%3E");
            }
            .ribbon {
                position: relative;
            }
            .ribbon::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                border-style: solid;
                border-width: 20px 20px 0 0;
                border-color: #C9ADC6 transparent transparent transparent;
            }
            .time-display {
                border-bottom: 1px dashed #D3C9C0;
            }
        }
    </style>

    <!-- 全局样式 -->
    <style>
        /* 自定义滚动条 */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: rgba(162, 136, 227, 0.1);
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb {
            background: rgba(162, 136, 227, 0.3);
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(162, 136, 227, 0.5);
        }
        
        /* 笔记内容样式 */
        .note-content {
            line-height: 1.8;
        }
        .note-content p {
            margin-bottom: 1.2rem;
        }
        .note-content h1, .note-content h2, .note-content h3 {
            margin: 1.5rem 0 1rem 0;
            font-weight: 600;
            color: #5D4E6D;
        }
        .note-content ul, .note-content ol {
            margin: 1rem 0 1rem 1.5rem;
        }
        .note-content li {
            margin-bottom: 0.5rem;
        }
        .note-content blockquote {
            border-left: 3px solid #C9ADC6;
            padding-left: 1rem;
            margin: 1rem 0;
            color: #8D86C9;
        }
    </style>
</head>
<body class="bg-diary-bg text-diary-text min-h-screen flex flex-col">
    <!-- 左侧导航边栏 -->
    <aside id="main-sidebar" class="fixed left-0 top-0 h-full w-64 bg-diary-paper diary-shadow transform transition-transform duration-300 z-50 md:translate-x-0 -translate-x-full">
        <div class="p-6 border-b border-diary-border">
            <h1 class="text-3xl font-title text-primary text-shadow">蘿嵐随记簿</h1>
            <p class="text-sm text-diary-text-secondary mt-2">记录生活中的点滴感悟</p>
        </div>
        <nav class="p-4">
            <ul class="space-y-2">
                <li>
                    <a href="index.html" class="flex items-center p-3 rounded-lg transition-all duration-200 hover:bg-accent-4/20 text-diary-text-secondary">
                        <i class="fa fa-home mr-3 text-lg"></i>
                        <span>茗沐大陆记事簿</span>
                    </a>
                </li>
                <li>
                    <a href="note.html" class="flex items-center p-3 rounded-lg bg-primary/10 text-primary transition-all duration-200">
                        <i class="fa fa-book mr-3 text-lg"></i>
                        <span>蘿嵐随记簿</span>
                    </a>
                </li>
                <li>
                    <a href="music.html" class="flex items-center p-3 rounded-lg transition-all duration-200 hover:bg-accent-4/20 text-diary-text-secondary">
                        <i class="fa fa-music mr-3 text-lg"></i>
                        <span>猫之都音乐馆</span>
                    </a>
                </li>
                <li>
                    <a href="photos.html" class="flex items-center p-3 rounded-lg transition-all duration-200 hover:bg-accent-4/20 text-diary-text-secondary">
                        <i class="fa fa-camera mr-3 text-lg"></i>
                        <span>摄影集</span>
                    </a>
                </li>
            </ul>
        </nav>
        
        <!-- 当前时间日期显示 -->
        <div class="absolute bottom-8 left-0 right-0 px-6">
            <div class="time-display p-4 bg-diary-paper/80 rounded-lg diary-shadow text-center">
                <div id="current-date" class="font-handwriting text-xl text-primary"></div>
                <div id="current-time" class="font-handwriting text-lg text-diary-text-secondary mt-1"></div>
            </div>
        </div>
    </aside>

    <!-- 遮罩层 -->
    <div id="overlay" class="fixed inset-0 bg-black/20 z-40 hidden md:hidden"></div>

    <!-- 主内容区域 -->
    <main class="flex-1 transition-all duration-300 md:ml-64">
        <!-- 顶部工具栏 -->
        <header class="sticky top-0 bg-diary-paper/90 backdrop-blur-sm z-30 p-4 flex items-center justify-between border-b border-diary-border">
            <!-- 移动端菜单按钮 -->
            <button id="sidebar-toggle" class="md:hidden text-primary p-2 rounded-lg hover:bg-primary/10">
                <i class="fa fa-bars text-xl"></i>
            </button>

            <!-- 笔记导航按钮 -->
            <div class="flex items-center space-x-2 md:space-x-4">
                <button id="prev-chapter" class="p-2 text-diary-text-secondary hover:text-primary transition-colors">
                    <i class="fa fa-chevron-left"></i>
                </button>
                <button id="next-chapter" class="p-2 text-diary-text-secondary hover:text-primary transition-colors">
                    <i class="fa fa-chevron-right"></i>
                </button>
            </div>

            <!-- 字体和排序控制 -->
            <div class="hidden md:flex items-center space-x-4">
                <div class="flex items-center space-x-2">
                    <button id="font-smaller" class="p-2 text-diary-text-secondary hover:text-primary transition-colors">
                        <i class="fa fa-text-height"></i>
                    </button>
                    <button id="font-larger" class="p-2 text-diary-text-secondary hover:text-primary transition-colors">
                        <i class="fa fa-text-height" style="transform: scaleY(1.5);"></i>
                    </button>
                </div>
                <div class="flex items-center space-x-2">
                    <button id="order-asc" class="p-2 text-primary transition-colors">
                        <i class="fa fa-sort-amount-asc"></i>
                    </button>
                    <button id="order-desc" class="p-2 text-diary-text-secondary hover:text-primary transition-colors">
                        <i class="fa fa-sort-amount-desc"></i>
                    </button>
                </div>
            </div>

            <!-- 笔记列表按钮 -->
            <button id="chapter-toggle" class="p-2 text-primary hover:bg-primary/10 rounded-lg transition-colors">
                <i class="fa fa-list-ul text-xl"></i>
            </button>
        </header>

        <!-- 笔记内容区域 -->
        <div class="max-w-3xl mx-auto p-6 md:p-8 bg-diary-paper paper-texture diary-shadow my-6 rounded-xl">
            <div class="mb-6 flex items-center justify-between">
                <div>
                    <h2 id="chapter-title" class="text-2xl font-handwriting text-primary text-shadow">清晨的微光</h2>
                    <p id="note-date" class="text-diary-text-secondary font-diary italic">2023年9月1日</p>
                </div>
            </div>
            
            <div id="reading-area" class="prose prose-lg max-w-none note-content font-diary">
                <!-- 笔记内容将在这里动态加载 -->
            </div>
        </div>

        <!-- 底部导航按钮（仅在移动端显示） -->
        <div class="md:hidden fixed bottom-6 left-0 right-0 flex justify-center">
            <div class="flex bg-diary-paper diary-shadow rounded-full px-2 py-1">
                <button id="prev-chapter-bottom" class="p-3 text-diary-text-secondary hover:text-primary transition-colors">
                    <i class="fa fa-chevron-left"></i>
                </button>
                <button id="font-smaller" class="p-3 text-diary-text-secondary hover:text-primary transition-colors">
                    <i class="fa fa-text-height"></i>
                </button>
                <button id="chapter-toggle-bottom" class="p-3 text-primary">
                    <i class="fa fa-list-ul"></i>
                </button>
                <button id="font-larger" class="p-3 text-diary-text-secondary hover:text-primary transition-colors">
                    <i class="fa fa-text-height" style="transform: scaleY(1.5);"></i>
                </button>
                <button id="next-chapter-bottom" class="p-3 text-diary-text-secondary hover:text-primary transition-colors">
                    <i class="fa fa-chevron-right"></i>
                </button>
            </div>
        </div>
    </main>

    <!-- 章节侧边栏 -->
    <aside class="chapter-sidebar fixed right-0 top-0 h-full w-72 bg-diary-paper diary-shadow transform translate-x-full transition-transform duration-300 z-40">
        <div class="p-6 border-b border-diary-border flex justify-between items-center">
            <h2 class="text-xl font-handwriting text-primary">笔记列表</h2>
            <button id="close-chapter" class="text-diary-text-secondary hover:text-primary">
                <i class="fa fa-times"></i>
            </button>
        </div>
        <div class="p-4 overflow-y-auto h-[calc(100%-6rem)]">
            <div id="chapter-list" class="space-y-1">
                <!-- 笔记列表将在这里动态渲染 -->
            </div>
        </div>
    </aside>

    <!-- 配置信息 -->
    <script>
        const config = {
            loadFromGithub: false, // 是否从GitHub加载文件
            github: {
                owner: 'your-username',
                repo: 'your-repo',
                branch: 'main',
                path: 'content/notes/'
            },
            localPath: 'content/notes/' // 本地文件路径
        };

        function getFileUrl(filename) {
            if (config.loadFromGithub) {
                return `https://raw.githubusercontent.com/${config.github.owner}/${config.github.repo}/${config.github.branch}/${config.github.path}${filename}`;
            } else {
                return `${config.localPath}${filename}`;
            }
        }
    </script>

    <script>
        // 全局变量
        let notes = [];              // 笔记列表
        let currentNoteIndex = 0;    // 当前笔记索引
        let sortOrder = 'asc';       // 排序方式：asc正序，desc逆序
        let fontSize = 100;          // 字体大小百分比
        let timeUpdateInterval;      // 时间更新定时器
        
        // DOM元素
        const mainSidebar = document.getElementById('main-sidebar');
        const sidebarToggle = document.getElementById('sidebar-toggle');
        const overlay = document.getElementById('overlay');
        const chapterSidebar = document.querySelector('.chapter-sidebar');
        const chapterToggle = document.getElementById('chapter-toggle');
        const chapterToggleBottom = document.getElementById('chapter-toggle-bottom');
        const closeChapter = document.getElementById('close-chapter');
        const chapterList = document.getElementById('chapter-list');
        const chapterTitle = document.getElementById('chapter-title');
        const noteDate = document.getElementById('note-date');
        const readingArea = document.getElementById('reading-area');
        const prevChapter = document.getElementById('prev-chapter');
        const nextChapter = document.getElementById('next-chapter');
        const prevChapterBottom = document.getElementById('prev-chapter-bottom');
        const nextChapterBottom = document.getElementById('next-chapter-bottom');
        const orderAsc = document.getElementById('order-asc');
        const orderDesc = document.getElementById('order-desc');
        const fontSmaller = document.getElementById('font-smaller');
        const fontLarger = document.getElementById('font-larger');
        const currentDateElement = document.getElementById('current-date');
        const currentTimeElement = document.getElementById('current-time');

        // 初始化
        document.addEventListener('DOMContentLoaded', () => {
            // 加载笔记列表
            loadNotes();
            
            // 绑定事件监听
            bindEvents();
            
            // 检查本地存储的设置
            loadSettings();
            
            // 初始化并启动时间显示
            updateDateTime();
            timeUpdateInterval = setInterval(updateDateTime, 1000);
        });

        // 更新当前时间和日期
        function updateDateTime() {
            const now = new Date();
            
            // 格式化日期：2023年10月15日 星期日
            const year = now.getFullYear();
            const month = now.getMonth() + 1;
            const day = now.getDate();
            const weekday = ['日', '一', '二', '三', '四', '五', '六'][now.getDay()];
            const formattedDate = `${year}年${month}月${day}日 星期${weekday}`;
            
            // 格式化时间：15:30:45
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            const formattedTime = `${hours}:${minutes}:${seconds}`;
            
            // 更新DOM
            currentDateElement.textContent = formattedDate;
            currentTimeElement.textContent = formattedTime;
        }

        // 渲染笔记列表
        function renderNoteList() {
            // 清空笔记列表
            chapterList.innerHTML = '';
            
            // 根据排序方式对笔记进行排序
            let sortedNotes = [...notes];
            if (sortOrder === 'asc') {
                sortedNotes.sort((a, b) => a.id - b.id);
            } else {
                sortedNotes.sort((a, b) => b.id - a.id);
            }
            
            // 渲染每个笔记
            sortedNotes.forEach((note, index) => {
                const noteItem = document.createElement('div');
                noteItem.className = `chapter-item p-3 cursor-pointer transition-all duration-200 rounded-lg ${
                    currentNoteIndex === notes.findIndex(c => c.id === note.id) ? 'bg-primary/10 text-primary border-l-4 border-primary' : 'hover:bg-accent-4/20'
                }`;
                noteItem.innerHTML = `
                    <div class="chapter-number text-xs text-diary-text-secondary mb-1 font-handwriting">第${note.id}篇</div>
                    <div class="chapter-title font-diary">${note.title}</div>
                `;
                
                // 绑定点击事件
                noteItem.addEventListener('click', () => {
                    // 找到原始笔记数组中的索引
                    const originalIndex = notes.findIndex(c => c.id === note.id);
                    loadNote(originalIndex);
                    
                    // 在移动设备上，点击笔记后关闭侧边栏
                    if (window.innerWidth < 768) {
                        chapterSidebar.classList.remove('active');
                    }
                });
                
                chapterList.appendChild(noteItem);
            });
        }

        // 加载笔记列表
        function loadNotes() {
            // 显示加载状态
            chapterList.innerHTML = `
                <div class="flex justify-center items-center h-64">
                    <i class="fa fa-spinner fa-spin text-primary"></i>
                    <span class="ml-2">加载笔记列表中...</span>
                </div>
            `;
            
            try {
                console.log('开始加载笔记列表...');
                
                // 根据项目结构，从仓库读取笔记文件
                notes = [
                    {
                        id: 1,
                        title: "清晨的微光",
                        date: "2023年9月1日",
                        file: "note1.md"
                    }
                ];
                
                console.log("笔记列表加载成功，共" + notes.length + "篇笔记", notes);
                
                // 渲染笔记列表
                renderNoteList();
                
                // 默认加载第一篇笔记
                if (notes.length > 0) {
                    loadNote(0);
                }
            } catch (error) {
                console.error("加载笔记列表时出错:", error);
                
                // 显示错误信息
                chapterList.innerHTML = `
                    <div class="flex flex-col justify-center items-center h-64 text-accent-2">
                        <i class="fa fa-exclamation-circle text-4xl mb-3"></i>
                        <p>无法加载笔记列表</p>
                        <p class="text-sm mt-2">错误: ${error.message}</p>
                    </div>
                `;
                
                // 回退到模拟数据
                notes = [
                    {
                        id: 1,
                        title: "清晨的微光",
                        date: "2023年9月1日",
                        file: "note1.md"
                    }
                ];
                
                renderNoteList();
                loadNote(0);
            }
        }

        // 加载笔记内容
        function loadNote(index) {
            if (index < 0 || index >= notes.length) return;
            
            // 更新当前笔记索引
            currentNoteIndex = index;
            
            // 更新笔记标题和日期
            chapterTitle.textContent = notes[index].title;
            noteDate.textContent = notes[index].date;
            
            // 显示加载状态
            readingArea.innerHTML = `
                <div class="flex justify-center items-center h-64">
                    <i class="fa fa-spinner fa-spin text-primary"></i>
                    <span class="ml-2">加载中...</span>
                </div>
            `;
            
            // 使用配置的URL请求笔记文件
            const filePath = getFileUrl(notes[index].file);
            
            console.log(`尝试加载笔记文件: ${filePath}`);
            
            fetch(filePath)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`无法加载文件: ${response.status} ${response.statusText}`);
                    }
                    return response.text();
                })
                .then(content => {
                    console.log(`笔记文件加载成功，内容长度: ${content.length}字符`);
                    
                    // 使用marked库将Markdown转换为HTML
                    readingArea.innerHTML = marked.parse(content);
                    
                    // 更新笔记列表选中状态
                    renderNoteList();
                    
                    // 更新导航按钮状态
                    updateNavButtons();
                    
                    // 滚动到顶部
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                })
                .catch(error => {
                    console.error("加载笔记内容时出错:", error);
                    
                    // 显示错误信息
                    readingArea.innerHTML = `
                        <div class="flex flex-col justify-center items-center h-64 text-center p-8">
                            <i class="fa fa-exclamation-circle text-4xl text-accent-2 mb-4"></i>
                            <p class="text-diary-text-secondary mb-2">无法加载笔记内容</p>
                            <p class="text-sm text-diary-text-secondary">错误信息: ${error.message}</p>
                            <p class="text-sm text-diary-text-secondary">文件路径: ${filePath}</p>
                            <p class="text-sm text-diary-text-secondary mt-2">提示: 请使用本地服务器运行项目以避免跨域问题</p>
                        </div>
                    `;
                });
        }

        // 更新导航按钮状态
        function updateNavButtons() {
            // 上一篇按钮
            if (currentNoteIndex <= 0) {
                prevChapter.disabled = true;
                prevChapterBottom.disabled = true;
            } else {
                prevChapter.disabled = false;
                prevChapterBottom.disabled = false;
            }
            
            // 下一篇按钮
            if (currentNoteIndex >= notes.length - 1) {
                nextChapter.disabled = true;
                nextChapterBottom.disabled = true;
            } else {
                nextChapter.disabled = false;
                nextChapterBottom.disabled = false;
            }
        }

        // 绑定事件监听
        function bindEvents() {
            // 侧边栏切换
            sidebarToggle.addEventListener('click', () => {
                mainSidebar.classList.toggle('-translate-x-full');
                overlay.classList.toggle('hidden');
            });
            
            // 点击遮罩层关闭侧边栏
            overlay.addEventListener('click', () => {
                mainSidebar.classList.add('-translate-x-full');
                overlay.classList.add('hidden');
            });
            
            // 笔记侧边栏切换
            chapterToggle.addEventListener('click', () => {
                chapterSidebar.classList.add('active');
            });
            
            chapterToggleBottom.addEventListener('click', () => {
                chapterSidebar.classList.add('active');
            });
            
            closeChapter.addEventListener('click', () => {
                chapterSidebar.classList.remove('active');
            });
            
            // 点击阅读区域中间位置打开笔记列表
            readingArea.addEventListener('click', (e) => {
                // 检查点击位置是否在阅读区域中间
                const rect = readingArea.getBoundingClientRect();
                const centerX = rect.left + rect.width / 2;
                const centerY = rect.top + rect.height / 2;
                const clickX = e.clientX;
                const clickY = e.clientY;
                
                // 如果点击位置在中心区域（100px范围内）
                if (Math.abs(clickX - centerX) < 100 && Math.abs(clickY - centerY) < 100) {
                    chapterSidebar.classList.toggle('active');
                }
            });
            
            // 笔记导航
            prevChapter.addEventListener('click', () => {
                if (currentNoteIndex > 0) {
                    loadNote(currentNoteIndex - 1);
                }
            });
            
            nextChapter.addEventListener('click', () => {
                if (currentNoteIndex < notes.length - 1) {
                    loadNote(currentNoteIndex + 1);
                }
            });
            
            prevChapterBottom.addEventListener('click', () => {
                if (currentNoteIndex > 0) {
                    loadNote(currentNoteIndex - 1);
                }
            });
            
            nextChapterBottom.addEventListener('click', () => {
                if (currentNoteIndex < notes.length - 1) {
                    loadNote(currentNoteIndex + 1);
                }
            });
            
            // 排序方式切换
            orderAsc.addEventListener('click', () => {
                sortOrder = 'asc';
                orderAsc.classList.add('text-primary');
                orderAsc.classList.remove('text-diary-text-secondary');
                orderDesc.classList.add('text-diary-text-secondary');
                orderDesc.classList.remove('text-primary');
                renderNoteList();
            });
            
            orderDesc.addEventListener('click', () => {
                sortOrder = 'desc';
                orderDesc.classList.add('text-primary');
                orderDesc.classList.remove('text-diary-text-secondary');
                orderAsc.classList.add('text-diary-text-secondary');
                orderAsc.classList.remove('text-primary');
                renderNoteList();
            });
            
            // 字体大小调节
            fontSmaller.addEventListener('click', () => {
                if (fontSize > 70) {
                    fontSize -= 10;
                    updateFontSize();
                    saveSettings();
                }
            });
            
            fontLarger.addEventListener('click', () => {
                if (fontSize < 150) {
                    fontSize += 10;
                    updateFontSize();
                    saveSettings();
                }
            });
        }

        // 更新字体大小
        function updateFontSize() {
            readingArea.style.fontSize = `${fontSize}%`;
        }

        // 保存设置到本地存储
        function saveSettings() {
            const settings = {
                fontSize: fontSize,
                sortOrder: sortOrder
            };
            
            localStorage.setItem('noteSettings', JSON.stringify(settings));
        }

        // 从本地存储加载设置
        function loadSettings() {
            const savedSettings = localStorage.getItem('noteSettings');
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                
                // 应用字体大小设置
                fontSize = settings.fontSize;
                updateFontSize();
                
                // 应用排序设置
                sortOrder = settings.sortOrder;
                if (sortOrder === 'asc') {
                    orderAsc.classList.add('text-primary');
                    orderAsc.classList.remove('text-diary-text-secondary');
                    orderDesc.classList.add('text-diary-text-secondary');
                    orderDesc.classList.remove('text-primary');
                } else {
                    orderDesc.classList.add('text-primary');
                    orderDesc.classList.remove('text-diary-text-secondary');
                    orderAsc.classList.add('text-diary-text-secondary');
                    orderAsc.classList.remove('text-primary');
                }
            }
        }

        // 页面卸载时清理定时器
        window.addEventListener('beforeunload', () => {
            clearInterval(timeUpdateInterval);
        });
    </script>
</body>
</html>
